<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GameOnX</title>

  <meta name="description" content="Tonton live streaming voli di GameOnX.">
  <meta property="og:title" content="GameOnX - Live Streaming">
  <meta property="og:description" content="Streaming olahraga terbaik hanya di GameOnX.">
  <meta property="og:image" content="/assets/og-image.jpg">
  <meta property="og:url" content="https://gameonx-apem.vercel.app">
  <link rel="icon" href="/assets/favicon.png" type="image/png">

  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

  <style>
    .blink {
      animation: blinker 1.5s linear infinite;
    }
    @keyframes blinker {
      50% { opacity: 0; }
    }
  </style>
</head>
<body class="bg-gray-900 text-white">

  <header class="flex justify-between items-center px-4 py-3">
    <div>
      <img src="assets/GoodGamesdsda.png" alt="GameOnX Logo" class="h-12">
    </div>
  </header>

  <main class="mt-6 flex justify-center">
    <div class="w-full max-w-4xl px-4">
      <video id="videoPlayer" controls class="w-full rounded-xl shadow-2xl bg-black" poster="assets/poster.png"></video>
    </div>
  </main>

  <section class="flex flex-wrap justify-center gap-6 max-w-7xl channel-container px-4 mt-10" id="channelList"></section>

  <script>
    const channels = [
      {
        title: "MotoGP",
        date: "TNT 2",
        src: "https://subrugopuciblchlvl6uqa666p23rig.happy-ending.site/c5phutHUkothlwRudRO8rosaS3B64ini.m3u8",
        poster: "https://cdn.motor1.com/images/mgl/40EzYz/s3/motogp-logo.jpg?width=1920"
      },
      {
        title: "Turkiye vs Brazil",
        date: "2025-07-19T13:30:00+07:00",
        src: "https://livecdn.euw1-0005.jwplive.com/live/sites/fM9jRrkn/media/WSwE6WlH/live.isml/.m3u8",
        poster: "https://cdn.jwplayer.com/v2/media/WSwE6WlH/poster.jpg?width=1920"
      },
      {
        title: "Germany vs USA",
        date: "2025-07-19T17:30:00+07:00",
        src: "https://livecdn.euw1-0005.jwplive.com/live/sites/fM9jRrkn/media/aS8EXfMk/live.isml/.m3u8",
        poster: "https://cdn.jwplayer.com/v2/media/aS8EXfMk/poster.jpg?width=1920"
      },
      {
        title: "Serbia vs Canada",
        date: "2025-07-19T21:30:00+07:00",
        src: "https://livecdn.euw1-0005.jwplive.com/live/sites/fM9jRrkn/media/TK44j28x/live.isml/.m3u8",
        poster: "https://cdn.jwplayer.com/v2/media/TK44j28x/poster.jpg?width=1920"
      },
      {
        title: "Bulgaria vs Poland",
        date: "2025-07-19T22:00:00+07:00",
        src: "https://livecdn.euw1-0005.jwplive.com/live/sites/fM9jRrkn/media/VIlLFZSP/live.isml/.m3u8",
        poster: "https://cdn.jwplayer.com/v2/media/VIlLFZSP/poster.jpg?width=1920"
      },
      {
        title: "Iran vs France",
        date: "2025-07-19T01:30:00+07:00",
        src: "https://livecdn.euw1-0005.jwplive.com/live/sites/fM9jRrkn/media/clFXRV38/live.isml/.m3u8",
        poster: "https://cdn.jwplayer.com/v2/media/clFXRV38/poster.jpg?width=1920"
      },
      {
        title: "Slovenia vs Italy",
        date: "2025-07-19T01:30:00+07:00",
        src: "https://livecdn.euw1-0005.jwplive.com/live/sites/fM9jRrkn/media/4bTTZYiP/live.isml/.m3u8",
        poster: "https://cdn.jwplayer.com/v2/media/4bTTZYiP/poster.jpg?width=1920"
      },    
      {
        title: "Turkiye vs Argentina",
        date: "2025-07-19T09:00:00+07:00",
        src: "https://livecdn.euw1-0005.jwplive.com/live/sites/fM9jRrkn/media/1aCO5bY5/live.isml/.m3u8",
        poster: "https://cdn.jwplayer.com/v2/media/1aCO5bY5/poster.jpg?width=1920"
      },    
      {
        title: "Germany vs Brazil",
        date: "2025-07-19T12:30:00+07:00",
        src: "https://livecdn.euw1-0005.jwplive.com/live/sites/fM9jRrkn/media/1x55Ewi0/live.isml/.m3u8",
        poster: "https://cdn.jwplayer.com/v2/media/1x55Ewi0/poster.jpg?width=1920"
      },
      {
        title: "USA vs Japan",
        date: "2025-07-19T17:20:00+07:00",
        src: "https://livecdn.euw1-0005.jwplive.com/live/sites/fM9jRrkn/media/qMJjQLs7/live.isml/.m3u8",
        poster: "https://cdn.jwplayer.com/v2/media/qMJjQLs7/poster.jpg?width=1920"
      },
      {
        title: "Ukraine vs Canada",
        date: "2025-07-19T18:00:00+07:00",
        src: "https://livecdn.euw1-0005.jwplive.com/live/sites/fM9jRrkn/media/gWh3cqml/live.isml/.m3u8",
        poster: "https://cdn.jwplayer.com/v2/media/gWh3cqml/poster.jpg?width=1920"
      },    
      {
        title: "China vs Cuba",
        date: "2025-07-19T18:30:00+07:00",
        src: "https://livecdn.euw1-0005.jwplive.com/live/sites/fM9jRrkn/media/Y5zXWkew/live.isml/.m3u8",
        poster: "https://cdn.jwplayer.com/v2/media/Y5zXWkew/poster.jpg?width=1920"
      },    
      {
        title: "Netherlands vs Italy",
        date: "2025-07-19T21:30:00+07:00",
        src: "https://livecdn.euw1-0005.jwplive.com/live/sites/fM9jRrkn/media/zWCW21FJ/live.isml/.m3u8",
        poster: "https://cdn.jwplayer.com/v2/media/zWCW21FJ/poster.jpg?width=1920"
      },    
      {
        title: "Bulgaria vs Iran",
        date: "2025-07-19T22:00:00+07:00",
        src: "https://livecdn.euw1-0005.jwplive.com/live/sites/fM9jRrkn/media/MlzCqA5F/live.isml/.m3u8",
        poster: "https://cdn.jwplayer.com/v2/media/MlzCqA5F/poster.jpg?width=1920"
      },    
      {
        title: "France vs Poland",
        date: "2025-07-19T01:30:00+07:00",
        src: "https://livecdn.euw1-0005.jwplive.com/live/sites/fM9jRrkn/media/SsxyN4Uo/live.isml/.m3u8",
        poster: "https://cdn.jwplayer.com/v2/media/SsxyN4Uo/poster.jpg?width=1920"
      },    
      {
        title: "Serbia vs Slovenia",
        date: "2025-07-19T01:30:00+07:00",
        src: "https://livecdn.euw1-0005.jwplive.com/live/sites/fM9jRrkn/media/agpcePYv/live.isml/.m3u8",
        poster: "https://cdn.jwplayer.com/v2/media/agpcePYv/poster.jpg?width=3201920"
      },    
    ];

    const container = document.getElementById("channelList");
    const video = document.getElementById("videoPlayer");
    let hls, frozenCheckInterval, lastBuffered = 0;

    function loadStreamCustom(el) {
      const src = el.dataset.src;
      const poster = el.dataset.poster;

      video.poster = poster;
      video.src = '';
      if (hls) {
        hls.destroy();
        hls = null;
      }

      if (window.Hls && Hls.isSupported()) {
        try {
          hls = new Hls();
          hls.loadSource(src);
          hls.attachMedia(video);
          hls.on(Hls.Events.MANIFEST_PARSED, function () {
            video.play();
            monitorStream(video, el);
          });
          hls.on(Hls.Events.ERROR, function (event, data) {
            console.error("HLS.js error:", data);
          });
        } catch (err) {
          console.error("HLS.js init error:", err);
        }
      } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
        video.src = src;
        video.addEventListener('loadedmetadata', function () {
          video.play();
        });
        monitorStream(video, el);
      } else {
        alert("HLS tidak didukung di browser ini.");
      }

      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function monitorStream(video, channelCard) {
      clearInterval(frozenCheckInterval);
      lastBuffered = 0;
      frozenCheckInterval = setInterval(() => {
        if (video.readyState < 3) return;
        const currentBuffered = video.buffered.length ? video.buffered.end(0) : 0;
        if (currentBuffered === lastBuffered) {
          alert("Stream telah berhenti. Channel akan dihapus.");
          if (hls) hls.destroy();
          video.pause();
          video.src = "";
          channelCard.remove();
          clearInterval(frozenCheckInterval);
        }
        lastBuffered = currentBuffered;
      }, 300000); // 5 menit
    }

    function formatDate(isoString) {
      const d = new Date(isoString);
      return d.toLocaleString("id-ID", { dateStyle: "medium", timeStyle: "short" });
    }

    function renderChannels() {
      const now = new Date();
      channels.forEach(ch => {
        const startTime = new Date(ch.date);
        const isLive = now >= startTime;

        const el = document.createElement("div");
        el.className = "bg-gray-800 rounded-xl p-4 shadow-md w-60 cursor-pointer hover:bg-red-700 text-center";
        el.setAttribute("onclick", "loadStreamCustom(this)");
        el.dataset.src = ch.src;
        el.dataset.poster = ch.poster;

        el.innerHTML = `
          <h3 class="text-white font-semibold border-b border-gray-500 mb-2">
            ${ch.title}
          </h3>
          ${isLive 
            ? '<div class="mt-2 text-red-500 text-xs font-bold blink">LIVE</div>' 
            : `<p class="text-gray-300 text-sm mt-2">${formatDate(ch.date)}</p>`}
        `;

        container.appendChild(el);
      });
    }

    renderChannels();
  </script>

</body>
</html>
